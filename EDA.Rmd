---
title: "EDA"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
NBATrendsData <- read.csv("./NBA-Fan-Support/NBATrendsData.csv")
library(lubridate)
library(tidyverse)

mean_pop <- aggregate(Popularity ~ Team, NBATrendsData, mean)

NBATrendsData <- NBATrendsData %>%
  mutate(
    Date = parse_date_time(Month, orders = "ym"),
    Month = month(Date, label = TRUE)
  )


```

Popularity by month
```{r}

NBATrendsData %>% 
  group_by(Month) %>%
  summarize(Popularity = mean(Popularity))
  
NBATrendsData %>% 
  ggplot(aes(Month, Popularity)) + geom_boxplot()

```

```{r}
#Creating Scatterplot with mean and median popularity score by month
# Red = median, blue = mean
NBATrendsData %>%
  group_by(Month) %>%
  summarize_at(vars(Popularity), funs(mean, median)) %>%
  ggplot() + geom_point(aes(x = Month, y = mean), col = "red") +
  geom_point(aes(x = Month, y = median), col = "blue") 
```

In this plot, the red dots represent the mean popularity score across
all 30 NBA teams for each month, whereas the blue dots represent the
median popularity score. We can see that for each month the mean
Google Trends search popularity score is lower than the median. This is
to be expected, since the data is skewed to the right, with the few
outlying popularity scores pulling up the mean. This difference between
the mean and median is even more pronounced in the months of April,
May, and June. This also makes sense because this during the NBA Playoff
season, and the popularity scores for the teams that make the playoff
skyrocket to near 100, causing the median to be largely inflated.


```{r}
NBATrendsData %>%
  group_by(Team) %>%
  summarize_at(vars(Popularity), funs(mean, median)) %>%
  ggplot() + geom_point(aes(x = Team, y = mean), col = "red") +
  geom_point(aes(x = Team, y = median), col = "blue") + 
    theme(axis.text.x = element_text(angle = 90, hjust = 1))

```

From this scatterplot, we see that the Sacramento kings have the highest
median and mean popularity score, by a large margin. The Portland
Trailblazers, Los Angeles Lakers, and Chicago Bulls are not far behind
either. The teams that appear to have the lowest mean and median
popularity scores are the Toronto Raptors, Oklahoma City Thunder, and
Houston Rockets.


```{r}
NBATrendsData %>% 
  filter(Team %in% c("Sacramento.Kings", "Los.Angeles.Lakers")) %>%
  ggplot(aes(x = Date, y = Popularity, color = Team)) + geom_line()

NBATrendsData %>% 
  filter(Date %within% interval("2018-04-01", "2018-06-01")) %>%
  ggplot(aes(x = Date, y = Popularity, color = Team)) + geom_line()


```

## Download all teams relative to all-time max (Celtics?)

Datasets:
- Dates of playoffs
    + window
    + when each round took place?
- How far each team went in playoffs each year
- Yearly reg season records
- ? key events or headlines?
